(window.webpackJsonp=window.webpackJsonp||[]).push([["app"],{"4Ozd":function(t,e,n){"use strict";n.r(e);var a={};n.r(a),n.d(a,"isEnabledBluetooth",function(){return Y}),n.d(a,"openBluetooth",function(){return Q}),n.d(a,"closeBluetooth",function(){return U}),n.d(a,"listenBluetoothStatus",function(){return Z}),n.d(a,"bondedDevices",function(){return W}),n.d(a,"isScanning",function(){return tt}),n.d(a,"scan",function(){return et}),n.d(a,"stopScan",function(){return nt}),n.d(a,"connect",function(){return at}),n.d(a,"disconnect",function(){return ot}),n.d(a,"connectedDevice",function(){return it}),n.d(a,"sendData",function(){return st}),n.d(a,"readData",function(){return rt});var o=n("Kw5r"),i=n("hqqE"),s=n("Ajsn"),r=n("sv92"),c=n("0sFx"),l=n("QWyR"),u=n("hAz3"),p=n("Frcb"),h=n("A3vH"),f=n("DpIT"),d=n("OXYZ"),g=n("8R8+"),v=n("FHfM"),m=n("+13h"),b=n("VXOH"),D=n("jo7b"),_=n("mbMf"),C=n("EDWr"),y=n("487+"),x=n("TCef"),w=n("v+dl"),S=n("4eHV"),T=n("x3bh"),B=n("mBN0"),M=n("3se+");o.a.component("f7-app",i.a),o.a.component("f7-page",s.a),o.a.component("f7-view",r.a),o.a.component("f7-navbar",c.a),o.a.component("f7-row",l.a),o.a.component("f7-col",u.a),o.a.component("f7-list",p.a),o.a.component("f7-list-item",h.a),o.a.component("f7-list-button",f.a),o.a.component("f7-list-input",d.a),o.a.component("f7-link",v.a),o.a.component("f7-button",g.a),o.a.component("f7-range",m.a),o.a.component("f7-popover",b.a),o.a.component("f7-popup",D.a),o.a.component("f7-block-title",_.a),o.a.component("f7-stepper",C.a),o.a.component("f7-toggle",y.a),o.a.component("f7-nav-right",x.a),o.a.component("f7-icon",w.a),o.a.component("f7-messagebar",S.a),o.a.component("f7-messages",T.a),o.a.component("f7-message",B.a),o.a.component("f7-messages-title",M.a);n("EpxS");var E=n("M+l/"),I=n("QTe6"),k=n("qrsU"),F=n("DzC0"),O=n("b6jo"),A=n("rg/g"),R=n("i57w"),N=n("qgs/"),V=n("Ak+C");E.a.use([I.a,k.a,F.a,O.a,A.a,R.a,N.a,V.a]);var P=E.a,G=n("7eDf"),L=(n("0eeA"),function(){var t=this.$createElement,e=this._self._c||t;return e("f7-app",{attrs:{params:this.f7params,"color-theme":this.colorTheme.colorTheme}},[e("f7-view",{ref:"f7MainView",attrs:{main:"",url:"/"}})],1)});L._withStripped=!0;var j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{staticClass:"car-control-page"},[n("div",{staticClass:"car-navbar"},[n("span",{staticClass:"car-navbar-title"},[t._v("小车控制")])]),t._v(" "),n("div",{staticClass:"car-option-panel"},[n("f7-row",[n("f7-col",{attrs:{width:"50"}},[n("f7-list",[n("f7-list-item",{attrs:{link:"#","popover-open":".bluetoothManage-popup"}},[n("div",{attrs:{slot:"title"},slot:"title"},[t.bluetoothData.connectedDevice?n("span",[t._v("\n                已连接到\n              ")]):n("span",[t._v("\n                连接蓝牙\n              ")])]),t._v(" "),n("div",{attrs:{slot:"after"},slot:"after"},[t.bluetoothData.connectedDevice?n("span",[t._v("\n                "+t._s(t.bluetoothData.connectedDevice.name)+"\n              ")]):n("span",[t._v("请连接设备")])])]),t._v(" "),n("f7-list-item",[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("当前速度:")]),t._v(" "),n("div",{attrs:{slot:"after"},slot:"after"},[n("span",[t._v(t._s(t.carInfo.leftSpeed)+" cm/s")]),t._v("  \n              "),n("span",[t._v(t._s(t.carInfo.rightSpeed)+" cm/s")])])])],1)],1),t._v(" "),n("f7-col",{attrs:{width:"50"}},[n("f7-list",[n("f7-list-item",{attrs:{link:"#","popover-open":".popover-mode"}},[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("小车模式:")]),t._v(" "),n("f7-link",[t._v(t._s(t.currentCarMode.label))])],1),t._v(" "),n("f7-list-item",[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("电池电压:")]),t._v(" "),n("div",{attrs:{slot:"after"},slot:"after"},[n("span",[t._v(t._s(t.carInfo.batteryVoltage)+" V")])])])],1)],1)],1),t._v(" "),n("f7-row",[n("f7-col",{attrs:{width:"70"}},[n("f7-list",{staticStyle:{margin:"-33px 0 0"}},[n("f7-list-item",[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("信息提示:")]),t._v(" "),n("div",{attrs:{slot:"after"},slot:"after"},[n("span",[t._v(t._s(t.sendError))])])])],1)],1),t._v(" "),n("f7-col",{attrs:{width:"30"}},[n("f7-button",{staticStyle:{margin:"-33px 0 0"},attrs:{"popover-open":".bluetoothMessage-popup"}},[t._v("\n          蓝牙串口调试\n        ")])],1)],1),t._v(" "),t.isControlCar?t._e():n("f7-row",{staticStyle:{"justify-content":"flex-start"}},[n("f7-col",{attrs:{width:"70"}},[n("f7-list",{staticStyle:{margin:"-1px 0 0"}},[n("f7-list-item",{attrs:{link:"#","popover-open":".popover-gunCharge"}},[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("充电参数:")]),t._v(" "),n("div",{attrs:{slot:"after"},slot:"after"},[n("f7-link",[t._v("速率: "+t._s(t.gunChargeRate)+" %")]),t._v("  \n              "),n("f7-link",[t._v("电压: "+t._s(t.gunChargeVoltage)+" V")])],1)])],1)],1),t._v(" "),n("f7-col",{staticStyle:{width:"140px"},attrs:{width:"30"}})],1)],1),t._v(" "),n("div",{staticClass:"car-expend-panel"},[n("div",{staticClass:"control-change-tab"},[n("div",{staticClass:"button-box control-change-tab-item",class:{active:t.isControlCar},on:{click:function(e){t.isControlCar=!0}}},[t._v("\n        遥控小车\n      ")]),t._v(" "),n("div",{staticClass:"button-box control-change-tab-item",class:{active:!t.isControlCar},on:{click:function(e){t.isControlCar=!1}}},[t._v("\n        遥控电磁炮\n      ")])]),t._v(" "),t.isControlCar?t._e():n("div",{staticClass:"control-change-tab",staticStyle:{"margin-top":"15px"}},[n("div",{staticClass:"control-change-tab-item",staticStyle:{width:"120px","border-right":"0"}},[n("f7-link",{attrs:{"popover-open":".chargeVol-popover"}},[t._v(" 当前电压: "+t._s(t.carInfo.gunVoltage)+" V")])],1),t._v(" "),n("div",{staticClass:"button-box control-change-tab-item",class:{active:t.isGunEmitActive()},staticStyle:{width:"80px"},on:{click:t.gunEmit}},[t.isGunEmitActive()?[t.gunEmitTimeNum>0?n("span",[t._v("取消 "+t._s(t.gunEmitTimeNum)+" s")]):n("span",[t._v("准备发射")])]:[n("span",[t._v("充电中...")])]],2)]),t._v(" "),t.isControlCar?t._e():n("div",{staticClass:"control-change-tab",staticStyle:{"margin-top":"5px"}},[n("div",{staticClass:"button-box control-change-tab-item",class:{active:t.gunEnableCharge},staticStyle:{width:"120px","flex-grow":"0"},on:{click:t.setGunEnableCharge}},[t.gunEnableCharge?t._e():n("span",[t._v("开始充电")]),t._v(" "),t.gunEnableCharge?n("span",[t._v("停止充电")]):t._e()])]),t._v(" "),t.isControlCar?t._e():n("div",{staticClass:"control-change-tab",staticStyle:{"margin-top":"5px"}},[n("div",{staticClass:"button-box control-change-tab-item",staticStyle:{width:"120px","flex-grow":"0"}},[n("span",[t._v("炮弹速度:"+t._s(t.gunBoomTime)+" us")])])]),t._v(" "),t.isControlCar?t._e():n("div",{staticClass:"control-change-tab",staticStyle:{"margin-top":"5px"}},[n("div",{staticClass:"button-box control-change-tab-item",staticStyle:{width:"100%","flex-grow":"1"}},[n("span",[t._v("方位:")]),t._v(" "),n("span",[t._v("x:"+t._s(t.mpu.angle0)+" ")]),t._v(" "),n("span",[t._v("y:"+t._s(t.mpu.angle1)+" ")]),t._v(" "),n("span",[t._v("z:"+t._s(t.mpu.angle2)+" ")])])])]),t._v(" "),t.isControlCar?n("div",{staticClass:"rocker-wrap"},[n("div",{staticStyle:{display:"flex",width:"calc(100% - 150px)","align-items":"flex-end","flex-wrap":"wrap"}},[n("div",{},[n("p",{staticClass:"range-title"},[t._v("翻斗起升: "+t._s(t.unloadDeg)+"度")]),t._v(" "),n("f7-range",{staticStyle:{width:"300px",height:"30px","margin-bottom":"10px"},attrs:{vertical:!1,min:0,max:t.maxUnloadDeg,label:!0,scale:!0,"scale-steps":6,"scale-sub-steps":2,step:1,value:t.unloadDeg},on:{"range:change":t.unloadDegRangeChange}}),t._v(" "),n("p",{staticClass:"range-title"},[t._v("小车转弯角度: "+t._s(t.turnDeg)+"度")]),t._v(" "),n("f7-range",{staticStyle:{width:"300px",height:"30px"},attrs:{vertical:!1,min:-t.maxTurnDeg,max:t.maxTurnDeg,label:!0,scale:!0,"scale-steps":6,"scale-sub-steps":0,step:1,value:t.turnDeg},on:{"range:change":t.turnDegRangeChange}})],1)]),t._v(" "),n("div",{staticStyle:{display:"flex",width:"150px","align-items":"center"}},[n("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center"}},[n("div",{staticStyle:{width:"40px",display:"flex","align-items":"center"}},[n("div",[n("f7-range",{ref:"speedRateRange",staticStyle:{width:"40px",height:"150px"},attrs:{vertical:!0,min:0,max:1,label:!0,scale:!0,"scale-steps":1,"scale-sub-steps":0,step:1,value:t.speedRate,"format-scale-label":t.formatSpeedRateScaleLabel},on:{"range:change":t.speedRateRangeChange}})],1)]),t._v(" "),n("div",[n("f7-range",{staticStyle:{width:"100px",height:"calc(100vh - 90px)","max-height":"400px"},attrs:{vertical:!0,min:-t.maxSpeed,max:t.maxSpeed,label:!0,scale:!0,"scale-steps":10,"scale-sub-steps":5,step:1,value:t.speed},on:{"range:change":t.speedRangeChange}}),t._v(" "),n("p",{staticClass:"range-title",staticStyle:{margin:"10px 0"}},[t._v("速度: "+t._s(t.speed*t.speedRate))])],1)])])]):t._e(),t._v(" "),t.isControlCar?t._e():n("div",{staticClass:"rocker-wrap"},[n("div",{staticStyle:{display:"flex",width:"calc(100% - 150px)","align-items":"flex-end","flex-wrap":"wrap"}},[n("div",{},[n("div",[n("p",{staticClass:"range-title"},[t._v("上弹机: "+t._s(t.gunBombDeg)+"度")]),t._v(" "),n("f7-range",{staticStyle:{width:"300px",height:"30px","margin-bottom":"10px"},attrs:{vertical:!1,min:0,max:t.maxGunBombDeg,label:!0,scale:!0,"scale-steps":6,"scale-sub-steps":2,step:1,value:t.gunBombDeg},on:{"range:change":t.gunBombDegRangeChange}}),t._v(" "),n("p",{staticClass:"range-title"},[t._v("炮塔朝向: "+t._s(t.gunThetaDeg)+"度")]),t._v(" "),n("f7-range",{staticStyle:{width:"300px",height:"30px"},attrs:{vertical:!1,min:-t.maxGunThetaDeg,max:t.maxGunThetaDeg,label:!0,scale:!0,"scale-steps":8,"scale-sub-steps":0,step:1,value:t.gunThetaDeg},on:{"range:change":t.gunThetaDegRangeChange}})],1)])]),t._v(" "),n("div",{staticStyle:{display:"flex",width:"150px","align-items":"center"}},[n("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center"}},[n("div",{staticStyle:{width:"40px",display:"flex","align-items":"center"}}),t._v(" "),n("div",[n("div",[n("f7-range",{ref:"gunPhiDeg",staticStyle:{width:"100px",height:"calc(100vh - 90px)","max-height":"400px"},attrs:{vertical:!0,min:t.minGunPhiDeg,max:t.maxGunPhiDeg,label:!0,scale:!0,"scale-steps":6,"scale-sub-steps":2,step:1,value:t.gunPhiDeg},on:{"range:change":t.gunPhiDegRangeChange}}),t._v(" "),n("p",{staticClass:"range-title",staticStyle:{margin:"10px 0"}},[t._v("炮塔起升: "+t._s(t.gunPhiDeg)+"度")])],1)])])])]),t._v(" "),n("f7-popover",{ref:"carMode",staticClass:"popover-mode"},[n("f7-block-title",[t._v("设置小车模式")]),t._v(" "),n("f7-list",t._l(t.carModeOptions,function(e,a){return n("f7-list-item",{key:a,attrs:{radio:"",title:e.label,name:"mode-radio",checked:e.value==t.currentCarMode.value},on:{change:function(n){return t.carModeChange(e)}}})}),1)],1),t._v(" "),n("f7-popover",{ref:"gunCharge",staticClass:"popover-gunCharge",staticStyle:{width:"320px"}},[n("f7-block-title",[t._v("设置充电参数")]),t._v(" "),n("f7-list",[n("f7-list-item",[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n          充电速率:\n        ")]),t._v(" "),n("div",{staticClass:"list-form-item-after",attrs:{slot:"after"},slot:"after"},[n("f7-stepper",{attrs:{min:0,max:100,step:.1,value:t.gunChargeRate},on:{"stepper:change":function(e){return t.gunChargeRate=e}}}),t._v(" "),n("span",[t._v("\n              %\n          ")])],1)]),t._v(" "),n("f7-list-item",[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n          充电电压:\n        ")]),t._v(" "),n("div",{staticClass:"list-form-item-after",attrs:{slot:"after"},slot:"after"},[n("f7-stepper",{attrs:{min:40,max:350,step:5,value:t.gunChargeVoltage},on:{"stepper:change":function(e){return t.gunChargeVoltage=e}}}),t._v(" "),n("span",[t._v("\n              V\n          ")])],1)])],1)],1),t._v(" "),n("f7-popup",{staticClass:"bluetoothManage-popup",attrs:{"swipe-to-close":"",opened:t.popupBluetoothManageOpened},on:{"popup:closed":function(e){t.popupBluetoothManageOpened=!1}}},[n("BluetoothManage",{attrs:{isPage:!1}})],1),t._v(" "),n("f7-popup",{staticClass:"bluetoothMessage-popup",attrs:{opened:t.popupOpened},on:{"popup:closed":function(e){t.popupOpened=!1}}},[n("BluetoothMessage")],1),t._v(" "),n("f7-popover",{staticClass:"chargeVol-popover",staticStyle:{width:"500px"}},[n("f7-list",{staticStyle:{margin:"0px"},attrs:{"tablet-inset":""}},[n("f7-list-item",{attrs:{title:"展示电压详情"},on:{click:function(e){t.isTraceGunChartVol=!t.isTraceGunChartVol}}},[n("f7-toggle",{attrs:{slot:"after",checked:t.isTraceGunChartVol},slot:"after"})],1)],1),t._v(" "),n("canvas",{attrs:{id:"chargeChart",width:"500",height:"300",role:"img"}})],1),t._v(" "),n("f7-popover",{ref:"pidPop",staticClass:"popover-pid",staticStyle:{width:"320px"}},[n("div",{staticStyle:{height:"80vh",overflow:"auto"}},[n("f7-block-title",[t._v("设置PID")]),t._v(" "),n("f7-list",[n("f7-list-input",{attrs:{label:"Kp",type:"number",value:t.pid.Kp,placeholder:"Kp"},on:{input:function(e){t.pid.Kp=e.target.value}}}),t._v(" "),n("f7-list-input",{attrs:{label:"Ti",type:"number",value:t.pid.Ti,placeholder:"Ti"},on:{input:function(e){t.pid.Ti=e.target.value}}}),t._v(" "),n("f7-list-input",{attrs:{label:"Td",type:"number",value:t.pid.Td,placeholder:"Td"},on:{input:function(e){t.pid.Td=e.target.value}}}),t._v(" "),n("f7-list-input",{attrs:{label:"T",type:"number",value:t.pid.TT,placeholder:"T"},on:{input:function(e){t.pid.TT=e.target.value}}}),t._v(" "),n("f7-list-button",{attrs:{fill:"",title:"设置"},on:{click:t.setPid}})],1)],1)])],1)};j._withStripped=!0;n("XfO3"),n("HEwt"),n("a1Th"),n("Btvt"),n("xfY5"),n("h/M4"),n("rE2o"),n("ioFf"),n("rGqo"),n("f3/d");function q(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.name=t||"",this.timerId=0,this.isPause=!1,this.isPauseCount=!1,this.currentCount=0,this.repeatCount=1,this.intervalTime=0,this.delayTime=0,this.timingStartFun=null,this.timingFun=null,this.timingEndFun=null,e&&q.timerArr.push(this)}q.timerArr=[],q.prototype.init=function(t){for(var e in t)e in this&&(this[e]=t[e]);return this},q.prototype.start=function(){var t=this;function e(){t.executeStartFun(),t.timerId=setInterval(function(){t.isPause||t.executeFun(),t.isPauseCount&&t.isPause||t.currentCount++,t.currentCount>=t.repeatCount&&(t.clear(),t.executeEndFun())},t.intervalTime)}return this.clear(),t.repeatCount>1?this.delayTime>0?this.timerId=setTimeout(function(){e()},this.delayTime):e():this.timerId=setTimeout(function(){t.executeEndFun()},this.delayTime),this},q.getTimerByName=function(t){var e=null;return q.timer.every(function(n,a){return!n||n.name!==t||(e=n,!1)}),e},q.prototype.clear=function(){return this.timerId&&(this.repeatCount>1?clearInterval(this.timerId):clearTimeout(this.timerId),this.timerId=0),this.currentCount=0,this},q.prototype.cancel=function(){var t=this;return this.clear(),q.timerArr.every(function(e,n){return e!==t||(q.timerArr.splice(n,1),!1)}),this},q.prototype.pauseTiming=function(){return this.isPause=!0,this},q.prototype.continueTiming=function(){return this.isPause=!1,this},q.prototype.executeStartFun=function(){this.timingStartFun&&this.timingStartFun()},q.prototype.executeFun=function(){this.timingFun&&this.timingFun()},q.prototype.executeEndFun=function(){this.timingEndFun&&this.timingEndFun()};var $=q;n("INYr");function H(){this.eventArr=[],this.useFunArr=[]}var K=new H;H.prototype.createEvent=function(t,e){return{name:t,isOnce:!1,callback:e}},H.prototype.getEvent=function(t,e){var n=e&&"function"==typeof e;return this.eventArr.filter(function(a){var o=a.name===t;return n&&(o=o&&a.callback===e),o})},H.prototype.removeEvent=function(t,e){var n=e&&"function"==typeof e;this.eventArr=this.eventArr.filter(function(a){var o=a.name===t;return n&&(o=o&&a.callback===e),!o})},H.prototype.off=function(t,e){this.removeEvent(t,e)},H.prototype.use=function(t){this.useFunArr.push(t)},H.prototype.useFilter=function(t,e){var n=this.useFunArr,a=n.length,o=0;return!a||(n[0](t,e,function i(){o++;o<a&&n[o](t,e,i)}),o===a-1)},H.prototype.on=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.createEvent(t,e);n&&(this.getEvent(t).length>0&&this.removeEvent(t));return this.eventArr.push(a),a},H.prototype.once=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.on(t,e,n).isOnce=!0},H.prototype.emit=function(t,e){var n=this.getEvent(t);if(this.useFilter(t,e))for(var a,o=n.length,i=0;i<o;i++)if("function"==typeof(a=n[i]).callback){var s=a.callback(e);if(a.isOnce&&this.removeEvent(event),void 0!==s&&!1===s)return}};n("KKXr");function z(t){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function J(t){if(!t)return 0;for(var e=t.length,n=0,a=0;a<e;a++)n+=t.charAt(a).charCodeAt();return n}function X(t){if(!t)return null;if(t.length<2)return null;var e={};return t.split("&").forEach(function(t){var n=t.split("=");2==n.length&&("true"==n[1]?e[n[0]]=!0:"false"==n[1]?e[n[0]]=!1:isNaN(n[1])?e[n[0]]=n[1]:e[n[0]]=1*n[1])}),e}function Y(t,e){window.api.require("cxgBluetoothSerial").isEnabledBluetooth({},function(n,a){a?e(a.msg,a.code):t(n.state)})}function Q(t,e){window.api.require("cxgBluetoothSerial").openBluetooth({},function(n,a){a?e(a.msg,a.code):t(n.state)})}function U(t,e){window.api.require("cxgBluetoothSerial").closeBluetooth({},function(n,a){a?e(a.msg,a.code):t(n.state)})}function Z(t,e){window.api.require("cxgBluetoothSerial").listenBluetoothStatus({},function(n,a){a?e(a.msg,a.code):t(n.status)})}function W(t,e){window.api.require("cxgBluetoothSerial").bondedDevices({},function(n,a){a?e(a.msg,a.code):t(n.data)})}function tt(t,e){window.api.require("cxgBluetoothSerial").isScanning({},function(n,a){a?e(a.msg,a.code):t(n.state)})}function et(t,e){window.api.require("cxgBluetoothSerial").scan({},function(n,a){a?e(a.msg,a.code):t(n.data)})}function nt(t,e){window.api.require("cxgBluetoothSerial").stopScan({},function(n,a){a?e(a.msg,a.code):t(n.state)})}function at(t,e,n){window.api.require("cxgBluetoothSerial").connect({address:n},function(n,a){a?e(a.msg,a.code):t(n.state)})}function ot(t,e){window.api.require("cxgBluetoothSerial").disconnect({},function(n,a){a?e(a.msg,a.code):t(n.state)})}function it(t,e){window.api.require("cxgBluetoothSerial").connectedDevice({},function(n,a){a?e(a.msg,a.code):t(n.data)})}function st(t,e,n){window.api.require("cxgBluetoothSerial").sendData({data:n},function(n,a){a?e(a.msg,a.code):t(n.state)})}function rt(t,e,n){window.api.require("cxgBluetoothSerial").readData({bufferSize:n},function(n,a){a?e(a.msg,a.code):t(n.data)})}var ct={pairedDevices:[],newDevices:[],sendData:"",errMsg:"",successMsg:"",connectedDevice:null,connectingDevice:null,isFindding:!1,enableBluetooth:!1,bufferSize:16},lt=null,ut=[];function pt(t){return!!lt||(t("蓝牙api未初始化"),!1)}function ht(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;if(pt(e))if(ct.enableBluetooth)if(ct.connectedDevice){var s=(new Date).getTime()%65535,r=function(t,e,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!e||"object"!=z(e))return"";var o=[];for(var i in e)o.push(i+"="+e[i]);n=n||(new Date).getTime()%65535;var s=o.join("&");if(!a)return"{".concat(t,",").concat(s,",").concat(n,"}");var r=J(s);return"{".concat(t,",").concat(s,",").concat(n,",").concat(r,"}")}(n,a,s,!0);lt.sendData(function(a){o?ut.push({eventName:n,timeId:s,expireTime:(new Date).getTime()+i,clear:!1,success:t,error:e}):t(a)},function(t){e(t)},r)}else e("蓝牙未连接到设备");else e("蓝牙未打开")}function ft(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128;pt(e)&&(ct.enableBluetooth?ct.connectedDevice?lt.readData(function(t){if("string"==typeof t)K.emit("bluetooth_data",t);else{var e=ut.findIndex(function(e){return e.eventName==t[0]&&e.timeId==t[2]});if(e>-1){var n=ut[e];return J(t[1])==t[3]?n.success(X(t[1])):n.error("网络欠佳, 数据校验失败!"),void ut.splice(e,1)}K.emit(t[0],X(t[1]))}},function(t){ct.connectedDevice=null,ct.errMsg=t,e&&e(t),K.emit("bluetooth_data_err",t)},n):e("蓝牙未连接到设备"):e("蓝牙未打开"))}setInterval(function(){var t=(new Date).getTime(),e=!1;ut.forEach(function(n,a,o){n.expireTime<t&&(e=!0,n.clear=!0,n.error&&n.error("暂无响应, 请稍后再试"))}),e&&(ut=ut.filter(function(t){return!0!==t.clear}))},50),K.once("apiready",function(){!function(t){lt=t}(a)});n("rvZc"),n("9VmF"),n("OG14"),n("Oyvg"),n("pIFo"),n("SRfc");function dt(t){return Object.prototype.toString.call(t).slice(8,-1)}function gt(t){return"Object"===dt(t)}function vt(t){return"Array"===dt(t)}function mt(t,e){if(!t)return"";var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[a]:("00"+n[a]).substr((""+n[a]).length)));return e}function bt(t,e){var n=0,a=0;try{n=t.toString().split(".")[1].length}catch(t){}try{a=e.toString().split(".")[1].length}catch(t){}return Number(t.toString().replace(".",""))/Number(e.toString().replace(".",""))*Math.pow(10,a-n)}function Dt(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3?arguments[3]:void 0;if(e&&(gt(e)||vt(e))?n?sessionStorage.setItem(t,JSON.stringify(e)):localStorage.setItem(t,JSON.stringify(e)):n?sessionStorage.setItem(t,e):localStorage.setItem(t,e),a){var o=JSON.stringify({time:(new Date).getTime(),expireTime:a});n?sessionStorage.setItem(t+"ExpireTime",o):localStorage.setItem(t+"ExpireTime",o)}}function _t(t,e,n){ht(e,n,t.eventName,t.data,t.response,t.timeout)}var Ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",[t.isPage?n("f7-navbar",{attrs:{"back-link":!0,sliding:!0}},[n("div",{staticClass:"title"},[t._v("蓝牙连接")])]):n("f7-navbar",[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n      蓝牙连接\n    ")]),t._v(" "),n("f7-nav-right",[n("f7-link",{attrs:{"popup-close":""}},[t._v("关闭")])],1)],1),t._v(" "),n("f7-list",{staticStyle:{margin:"0px"},attrs:{"tablet-inset":""}},[n("f7-list-item",{attrs:{title:"打开蓝牙"},on:{"!click":function(e){return t.openOrCloseBluetooth(e)}}},[n("f7-toggle",{attrs:{slot:"after",disabled:!0,checked:t.bluetoothData.enableBluetooth},slot:"after"})],1)],1),t._v(" "),n("f7-block-title",[t._v("已配对的设备")]),t._v(" "),n("f7-list",[t._l(t.bluetoothData.pairedDevices,function(e,a){return n("f7-list-item",{key:a,staticClass:"bluetooth-item",attrs:{link:"#"},on:{click:function(n){return t.confirmConnDevice(e)}}},[n("div",{attrs:{slot:"media"},slot:"media"},[t.bluetoothData.connectingDevice===e?n("f7-icon",{staticClass:"active loading",attrs:{material:"refresh"}}):n("f7-icon",{class:{active:t.activeDevice(e)},attrs:{material:"bluetooth"}})],1),t._v(" "),n("f7-row",{class:{active:t.activeDevice(e)},attrs:{slot:"title"},slot:"title"},[n("f7-col",{staticStyle:{"font-weight":"bold",width:"150px"}},[t._v("\n          "+t._s(e.name)+"\n        ")]),t._v(" "),n("f7-col",{staticStyle:{width:"calc(100% - 150px)"},attrs:{width:"60"}},[t._v("\n          "+t._s(e.address)+"\n        ")])],1)],1)}),t._v(" "),0===t.bluetoothData.pairedDevices.length?n("f7-list-item",[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n        未获取到已配对的设备\n      ")])]):t._e()],2),t._v(" "),n("f7-block-title",[t._v("新的设备")]),t._v(" "),n("f7-list",[t._l(t.bluetoothData.newDevices,function(e,a){return n("f7-list-item",{key:a,staticClass:"bluetooth-item",attrs:{link:"#"},on:{click:function(n){return t.confirmConnDevice(e)}}},[n("div",{attrs:{slot:"media"},slot:"media"},[t.bluetoothData.connectingDevice===e?n("f7-icon",{staticClass:"active loading",attrs:{material:"refresh"}}):n("f7-icon",{class:{active:t.activeDevice(e)},attrs:{material:"bluetooth"}})],1),t._v(" "),n("f7-row",{class:{active:t.activeDevice(e)},attrs:{slot:"title"},slot:"title"},[n("f7-col",{staticStyle:{"font-weight":"bold"},attrs:{width:"40"}},[t._v("\n          "+t._s(e.name)+"\n        ")]),t._v(" "),n("f7-col",{attrs:{width:"60"}},[t._v("\n          "+t._s(e.address)+"\n        ")])],1)],1)}),t._v(" "),0===t.bluetoothData.pairedDevices.length?n("f7-list-item",[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n        未发现新的设备\n      ")])]):t._e()],2),t._v(" "),n("f7-button",{attrs:{fill:""},on:{click:function(e){return t.scanDevices()}}},[t.bluetoothData.isFindding?n("f7-preloader",{attrs:{color:"blue"}}):t._e(),t._v(" "),t.bluetoothData.isFindding?n("span",[t._v("停止搜索")]):n("span",[t._v("搜索蓝牙设备")])],1),t._v(" "),t.isPage?n("f7-button",{attrs:{fill:""},on:{click:function(e){t.popupOpened=!0}}},[t._v("发送消息")]):t._e(),t._v(" "),t.isPage?n("f7-popup",{staticClass:"demo-popup",attrs:{"swipe-to-close":"",opened:t.popupOpened},on:{"popup:closed":function(e){t.popupOpened=!1}}},[n("BluetoothMessage")],1):t._e()],1)};Ct._withStripped=!0;n("dRSK");var yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",[n("f7-navbar",[n("div",{attrs:{slot:"title"},slot:"title"},[t.bluetoothData.connectedDevice?n("span",[t._v("\n        已连接到 "+t._s(t.bluetoothData.connectedDevice.name)+"\n      ")]):n("span",[n("f7-link",{attrs:{link:"/bluetooth","popup-close":""}},[t._v("连接蓝牙")])],1)]),t._v(" "),n("f7-nav-right",[n("f7-link",{attrs:{"popup-close":""}},[t._v("关闭")])],1)],1),t._v(" "),n("f7-messagebar",{ref:"messagebar",attrs:{placeholder:"请输入消息","sheet-visible":t.sheetVisible}},[n("f7-link",{attrs:{slot:"inner-end","icon-ios":"f7:arrow_up_fill","icon-aurora":"f7:arrow_up_fill","icon-md":"material:send"},on:{click:t.sendMessage},slot:"inner-end"})],1),t._v(" "),n("f7-messages",{ref:"messages"},[n("f7-messages-title",[t._v(t._s(t.nowDateTime))]),t._v(" "),t._l(t.messagesData,function(e,a){return n("f7-message",{key:a,attrs:{type:e.type,name:e.name,first:t.isFirstMessage(e,a),last:t.isLastMessage(e,a),tail:t.isTailMessage(e,a)}},["received"==e.type?n("div",{attrs:{slot:"avatar"},slot:"avatar"},[n("f7-icon",{staticStyle:{color:"var(--f7-theme-color)"},attrs:{material:"bluetooth"}})],1):t._e(),t._v(" "),e.text?n("span",{attrs:{slot:"text"},domProps:{textContent:t._s(e.text)},slot:"text"}):t._e()])}),t._v(" "),t.typingMessage?n("f7-message",{attrs:{type:"received",typing:!0,first:!0,last:!0,tail:!0,header:t.typingMessage.name+" is typing",avatar:t.typingMessage.avatar}}):t._e()],2)],1)};yt._withStripped=!0;var xt={bluetoothData:ct,attachments:[],sheetVisible:!1,typingMessage:null,nowDateTime:mt(new Date,"yyyy-MM-dd HH:mm"),messagesData:[],responseInProgress:!1},wt={data:function(){return xt},computed:{},created:function(){var t=this;this.receiveDataCallback=function(e){e.trim()&&(t.messagesData.length>30&&(t.messagesData=t.messagesData.slice(20)),t.messagesData.push({text:e,type:"received",name:ct.connectedDevice.name}))},K.on("bluetooth_data",this.receiveDataCallback)},mounted:function(){var t=this;t.$f7ready(function(){t.messagebar=t.$refs.messagebar.f7Messagebar,t.messages=t.$refs.messages.f7Messages})},methods:{isFirstMessage:function(t,e){var n=this.messagesData[e-1];return!t.isTitle&&(!n||n.type!==t.type||n.name!==t.name)},isLastMessage:function(t,e){var n=this.messagesData[e+1];return!t.isTitle&&(!n||n.type!==t.type||n.name!==t.name)},isTailMessage:function(t,e){var n=this.messagesData[e+1];return!t.isTitle&&(!n||n.type!==t.type||n.name!==t.name)},sendMessage:function(){var t=this,e=this,n=e.messagebar.getValue().replace(/\n/g,"<br>").trim();0!=n.trim().length&&(e.responseInProgress||(e.responseInProgress=!0,function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";pt(e)&&(ct.enableBluetooth?ct.connectedDevice?lt.sendData(function(e){t(e)},function(t){e(t)},n):e("蓝牙未连接到设备"):e("蓝牙未打开"))}(function(){e.messagebar.clear(),e.messagesData.push({type:"sent",text:n}),e.responseInProgress=!1},function(n){e.responseInProgress=!1,t.$f7.toast.create({text:n,position:"center",closeTimeout:3e3}).open()},n)))}},destroyed:function(){K.off("bluetooth_data",this.receiveDataCallback)}},St=n("KHd+"),Tt=Object(St.a)(wt,yt,[],!1,null,"7590aa74",null);Tt.options.__file="src/modules/app/components/bluetooth/BluetoothMessage.vue";var Bt=Tt.exports;function Mt(t){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Et=!0,It={name:"BluetoothManage",components:{BluetoothMessage:Bt},data:function(){return{bluetoothData:ct,popupOpened:!1}},props:{isPage:{type:Boolean,default:!0}},watch:{successMsg:function(){this.$f7.toast.create({text:this.successMsg,position:"center",closeTimeout:3e3}).open()},errMsg:function(){this.$f7.toast.create({text:this.errMsg,position:"center",closeTimeout:3e3}).open()}},created:function(){},mounted:function(){this.init()},computed:{},methods:{activeDevice:function(t){return this.bluetoothData.connectedDevice&&this.bluetoothData.connectedDevice.address===t.address},init:function(){var t=this;Et&&(this.exeFunc=function(){t.isEnabledBluetooth(),t.getBondedDevices(),t.getConnectedDevice(),t.listenBluetoothStatus()},window.isInitApiready?this.exeFunc():K.once("apiready",this.exeFunc),Et=!1)},isEnabledBluetooth:function(){var t=this;!function(t,e){pt(e)&&lt.isEnabledBluetooth(t,e)}(function(e){t.bluetoothData.enableBluetooth=e,t.bluetoothData.enableBluetooth||t.openBluetooth()},function(e){t.bluetoothData.errMsg=e})},listenBluetoothStatus:function(){var t=this;!function(t,e){pt(e)&&lt.listenBluetoothStatus(t,e)}(function(e){switch(e){case"STATE_ON":t.bluetoothData.enableBluetooth=!0,t.getBondedDevices();break;case"STATE_OFF":t.bluetoothData.enableBluetooth=!1}},function(e){t.bluetoothData.errMsg=e})},openOrCloseBluetooth:function(){var t=this;this.bluetoothData.enableBluetooth?this.$f7.dialog.confirm("确定要关闭蓝牙?","提示",function(){t.closeBluetooth()}):this.openBluetooth()},openBluetooth:function(){var t=this;!function(t,e){pt(e)&&lt.openBluetooth(t,e)}(function(){t.getBondedDevices(),t.bluetoothData.enableBluetooth=!0,t.bluetoothData.successMsg="蓝牙打开成功"},function(e){t.bluetoothData.errMsg=e,t.bluetoothData.enableBluetooth=!1})},closeBluetooth:function(){var t=this;!function(t,e){pt(e)&&lt.closeBluetooth(t,e)}(function(){t.bluetoothData.successMsg="蓝牙关闭成功",t.bluetoothData.isFindding=!1,t.bluetoothData.connectedDevice=null,t.bluetoothData.connectingDevice=null,t.bluetoothData.enableBluetooth=!1},function(e){t.bluetoothData.errMsg=e})},autoConnectLastDevice:function(){if(this.bluetoothData.enableBluetooth&&!this.bluetoothData.connectedDevice){var t=function t(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=null,o=null;if(a=n?sessionStorage.getItem(e):localStorage.getItem(e)){var i=t(e+"ExpireTime",n);if(i&&(new Date).getTime()-i.time>=i.expireTime)return Dt(e,null,n),null;var s=a.charAt(0);if("{"===s||"["===s)o=JSON.parse(a);else try{o=JSON.parse(a)}catch(t){o=a}}else o=a;return o}("bluetooth_connected",!1);if(t){var e=this.bluetoothData.pairedDevices.find(function(e){return e.address==t.address});e&&this.connDevice(e)}}},getBondedDevices:function(){var t=this;!function(t,e){pt(e)&&lt.bondedDevices(t,e)}(function(e){t.bluetoothData.pairedDevices=e},function(e){t.bluetoothData.errMsg=e})},scanDevices:function(){var t=this;this.bluetoothData.enableBluetooth&&(this.bluetoothData.isFindding?this.stopScanDevices():(this.bluetoothData.isFindding=!0,this.bluetoothData.newDevices=[],function(t,e){pt(e)&&lt.scan(t,e)}(function(e){"ACTION_DISCOVERY_FINISHED"===e&&(t.bluetoothData.isFindding=!1),"object"===Mt(e)&&t.bluetoothData.newDevices.push(e)},function(e){t.bluetoothData.errMsg=e,t.bluetoothData.isFindding=!1})))},stopScanDevices:function(){var t=this;this.bluetoothData.enableBluetooth&&this.bluetoothData.isFindding&&function(t,e){pt(e)&&lt.stopScan(t,e)}(function(e){t.bluetoothData.isFindding=!1},function(e){t.bluetoothData.errMsg=e,t.bluetoothData.isFindding=!1})},confirmConnDevice:function(t){var e=this;this.bluetoothData.enableBluetooth&&(t?this.bluetoothData.connectedDevice&&this.bluetoothData.connectedDevice.name!==t.name?this.$f7.dialog.confirm("确定要连接到 "+t.name+" ?","提示",function(){e.connDevice(t)}):this.connDevice(t):this.bluetoothData.errMsg="请输入蓝牙设备地址!")},connDevice:function(t){var e=this;this.connectedDevice!==t?(this.bluetoothData.connectingDevice=t,function(t,e,n){pt(e)&&lt.connect(function(e){t(e),K.emit("bluetooth_connect",e)},e,n)}(function(){e.bluetoothData.connectingDevice=null,e.bluetoothData.successMsg="蓝牙连接成功",e.bluetoothData.connectedDevice=t,ft(),Dt("bluetooth_connected",t,!1),K.on("bluetooth_data_err",function(t){e.autoConnectLastDevice()})},function(t){e.bluetoothData.errMsg=t,e.bluetoothData.connectingDevice=null},t.address)):this.disConnDevice()},disConnDevice:function(){var t=this;this.bluetoothData.connectedDevice&&(this.bluetoothData.connectingDevice=this.bluetoothData.connectedDevice,function(t,e){pt(e)&&lt.disconnect(t,e)}(function(e){t.bluetoothData.connectedDevice=null,t.bluetoothData.connectingDevice=null,K.off("bluetooth_data_err")},function(e){t.bluetoothData.errMsg=e,t.bluetoothData.connectingDevice=null}))},getConnectedDevice:function(){var t=this;!function(t,e){pt(e)&&lt.connectedDevice(t,e)}(function(e){t.bluetoothData.connectedDevice=e,t.bluetoothData.connectingDevice=null,e?(t.bluetoothData.enableBluetooth=!0,ft(),Dt("bluetooth_connected",e,!1),K.on("bluetooth_data_err",function(e){t.autoConnectLastDevice()})):t.autoConnectLastDevice()},function(e){t.bluetoothData.errMsg=e,t.bluetoothData.connectingDevice=null})}},destroyed:function(){}},kt=(n("9tj0"),Object(St.a)(It,Ct,[],!1,null,"89c8f8f0",null));kt.options.__file="src/modules/app/components/bluetooth/BluetoothManage.vue";var Ft=kt.exports,Ot=n("URgk");function At(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Rt=new $("clearErrMsg"),Nt=new $("sendControlTimer"),Vt=new $("gunEmit"),Pt=null,Gt=[[10,100],[20,200],[30,200]];function Lt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return 1*(6.6*t/4096).toFixed(e)}var jt={STOP:1,CONTROL:2,TRACE:3,AVOIDING:4,1:"静止",2:"手动遥控",3:"自动避障",4:"自动寻迹"},qt=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];if(gt(t))for(var a in t)t.hasOwnProperty(a)&&e^isNaN(a)&&n.push({label:t[a],value:a});return n}(jt,!0),$t={popupOpened:!1,popupBluetoothManageOpened:!1,bluetoothData:ct,carModeOptions:qt,currentCarMode:qt[0],carInfo:{humiture:{tem:0,hum:0,error:""},leftSpeed:0,rightSpeed:0,batteryVoltage:0,gunVoltage:0},isCarBack:!1,speed:0,turnDeg:0,unloadDeg:0,maxSpeed:250,maxTurnDeg:45,maxUnloadDeg:120,sendError:"",speedRate:0,isControlCar:!0,gunThetaDeg:0,maxGunThetaDeg:80,gunBombDeg:0,maxGunBombDeg:180,gunPhiDeg:0,maxGunPhiDeg:75,minGunPhiDeg:-15,gunChargeRate:20,gunChargeVoltage:50,gunEmitTimeNum:0,gunEnableCharge:!1,gunBoomTime:0,pid:{Kp:20,Ti:500,Td:1,TT:1},mpu:{angle0:0,angle1:0,angle2:0},isTraceGunChartVol:!1,tempCount:0,temp:0,temp2:0},Ht={name:"carControl",components:{BluetoothManage:Ft,BluetoothMessage:Bt},data:function(){return $t},props:{},computed:{},watch:{sendError:function(){Rt.start()}},beforeCreate:function(){window.screen&&window.screen.orientation.lock&&window.screen.orientation.lock("landscape").catch(function(t){})},created:function(){},methods:{setActiveCarMode:function(t){if(t){var e=!0,n=!1,a=void 0;try{for(var o,i=qt[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var s=o.value;if(s.value==t){this.currentCarMode=s;break}}}catch(t){n=!0,a=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw a}}}},toBluetooth:function(){this.$f7router.navigate("/bluetooth")},formatSpeedRateScaleLabel:function(t){return 1==t?"前进":0==t?"停止":-1==t?"后退":void 0},isGunEmitActive:function(){if(!(this.carInfo.gunVoltage<40))return Math.abs(this.carInfo.gunVoltage-this.gunChargeVoltage)<10},carModeChange:function(t){var e=this;if(!this.sendCarInfoLoading){var n=this.currentCarMode.value;this.setActiveCarMode(t.value),this.sendCarInfoLoading=!0,_t({data:{cm:t.value},eventName:"carInfo",response:!0,timeout:2e3},function(t){e.sendCarInfoLoading=!1,Object(Ot.setTimeout)(function(){e.setActiveCarMode(t.cm)},100)},function(t){e.sendError=t,e.sendCarInfoLoading=!1,Object(Ot.setTimeout)(function(){e.setActiveCarMode(n)},100)})}},carBackChange:function(t){this.isCarBack=t,this.sendCarInfo()},speedRangeChange:function(t){this.speed=t},speedRateRangeChange:function(t){this.speedRate!=t&&(this.speed=0,this.$refs.speedRateRange.setValue(this.speed)),this.speedRate=t},turnDegRangeChange:function(t){this.turnDeg=t},unloadDegRangeChange:function(t){this.unloadDeg=t},gunThetaDegRangeChange:function(t){this.gunThetaDeg=t},gunPhiDegRangeChange:function(t){this.gunPhiDeg=t},gunBombDegRangeChange:function(t){this.gunBombDeg=t},sendCarInfo:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sendCarInfoLoading||(this.sendCarInfoLoading=!0,_t({data:e,eventName:"carInfo",response:!0,timeout:2e3},function(e){t.sendCarInfoLoading=!1,t.carInfo.leftSpeed=bt(1*e.ls,100),t.carInfo.rightSpeed=bt(1*e.rs,100),t.carInfo.batteryVoltage=Lt(1*e.bv),t.setActiveCarMode(e.cm)},function(e){t.sendError=e,t.sendCarInfoLoading=!1}))},sendCarData:function(){var t=this;this.sendCarDataLoading||(this.sendCarDataLoading=!0,_t({data:{sp:this.speed*this.speedRate,td:Math.floor(1.5*this.turnDeg),ud:this.unloadDeg},eventName:"carData",response:!0,timeout:2e3},function(e){t.sendCarDataLoading=!1,t.carInfo.leftSpeed=bt(1*e.ls,100),t.carInfo.rightSpeed=bt(1*e.rs,100),t.carInfo.batteryVoltage=Lt(1*e.bv),t.setActiveCarMode(e.cm)},function(e){t.sendError=e,t.sendCarDataLoading=!1}))},sendGunData:function(){var t=this;this.sendGunDataLoading||(this.setT=(new Date).getTime(),this.sendGunDataLoading=!0,_t({data:{ud:this.unloadDeg,gtd:this.gunThetaDeg+90,gpd:this.gunPhiDeg+90,gbd:180-this.gunBombDeg,gcr:Math.floor(655.35*this.gunChargeRate),gcv:function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],Math.ceil(4096*t/(3.3*101))}(this.gunChargeVoltage),gec:this.gunEnableCharge?1:0},eventName:"gunData",response:!0,timeout:2e3},function(e){t.sendGunDataLoading=!1,t.setActiveCarMode(e.cm),t.addGunChargeVol(e),t.carInfo.batteryVoltage=Lt(1*e.bv),t.mpu.angle0=e.an0,t.mpu.angle1=e.an1,t.mpu.angle2=e.an2,t.tempCount++},function(e){t.tempCount++,t.sendError=e,t.sendGunDataLoading=!1}))},gunEmit:function(){var t=this;if(this.isGunEmitActive()){if(this.gunEmitTimeNum>0)return this.gunEmitTimeNum=0,void Vt.cancel();this.gunEmitTimeNum=5,Vt.init({intervalTime:1e3,repeatCount:this.gunEmitTimeNum,delayTime:0,timingFun:function(){t.gunEmitTimeNum--},timingEndFun:function(){t.gunEmitTimeNum=0,_t({data:{emit:!0},eventName:"gunEmit",response:!0,timeout:2e3},function(t){},function(e){t.sendError=e})}}).start()}},setGunEnableCharge:function(){this.gunEnableCharge=!this.gunEnableCharge,Gt=[]},addGunChargeVol:function(t){if(t){var e=1*t.gt,n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return 1*(t*(3.3*101)/4096).toFixed(e)}(t.gv,1);if((e%3e4<200||e%3e4>29800)&&(Gt=[]),Gt.length>180&&(Gt=[]),Gt.push([e,n]),this.carInfo.gunVoltage=n,Pt){var a=Gt.slice(-11,-1).map(function(t){return t[1]});Math.min.apply(Math,At(a)),Math.max.apply(Math,At(a));Pt.data.datasets.forEach(function(t){t.data=Gt.map(function(t){return{x:t[0],y:t[1]}})}),Pt.update()}}},setPid:function(){var t=this;_t({data:this.pid,eventName:"setPid",response:!0,timeout:2e3},function(t){alert("设置成功!")},function(e){t.sendError=e})}},mounted:function(){var t=this;Rt.init({intervalTime:0,repeatCount:0,delayTime:3e3,timingEndFun:function(){t.sendError=""}}).start(),Nt.init({intervalTime:0,repeatCount:Number.MAX_SAFE_INTEGER,delayTime:0,timingFun:function(){t.sendCarInfoLoading||ct.enableBluetooth&&ct.connectedDevice&&t.currentCarMode.value==jt.CONTROL&&(t.isControlCar&&t.sendCarData(),t.isControlCar||t.sendGunData())}}).start(),this.onBluetooth_connDevice=function(){t.sendCarInfo()},K.on("bluetooth_connDevice",this.onBluetooth_connDevice),Object(Ot.setTimeout)(function(){Promise.all([n.e("chunk-f090"),n.e("aZwk")]).then(function(){var t=[n("aZwk")];(function(){var t=document.getElementById("chargeChart").getContext("2d");Pt=new Chart(t,{type:"scatter",data:{datasets:[{label:"Scatter Dataset",data:[]}]},options:{scales:{xAxes:[{type:"linear",position:"bottom"}]}}})}).apply(null,t)}).catch(n.oe)},2e3),K.on("boomSpeed",function(e){t.gunBoomTime=e.t})},destroyed:function(){window.screen&&window.screen.orientation.unlock&&window.screen.orientation.unlock(),Rt.clear(),Nt.clear(),K.off("boomSpeed"),K.off("bluetooth_connDevice",this.onBluetooth_connDevice)}},Kt=(n("edrR"),Object(St.a)(Ht,j,[],!1,null,null,null));Kt.options.__file="src/modules/app/pages/Home.vue";var zt=Kt.exports,Jt={color:"purple",colorTheme:"purple",textColor:"purple",bgColor:"",borderTheme:"",rippleColor:"",themeDark:!1,primary:"purple"},Xt={name:"My App",id:"com.chengxg.app",routes:[{path:"/",component:zt,master:!0,options:{history:!0,pushState:!0,animate:!1},routes:[]},{path:"/bluetooth",component:Ft}],touch:{fastClicks:!0}},Yt={name:"app",components:{Home:zt},data:function(){return{f7params:Xt,colorTheme:Jt}},methods:{},watch:{$route:function(t,e){}},mounted:function(){}},Qt=Object(St.a)(Yt,L,[],!1,null,null,null);Qt.options.__file="src/modules/app/App.vue";var Ut=Qt.exports;P.use(G.a),o.a.config.productionTip=!1;try{window.isInitApiready=!1,window.apiready=function(){window.isInitApiready=!0,K.emit("apiready"),api.setScreenOrientation({orientation:"auto_landscape"})}}catch(t){}new o.a({el:"#app",components:{App:Ut},render:function(t){return t(Ut)}})},"9tj0":function(t,e,n){"use strict";var a=n("cNQO");n.n(a).a},EpxS:function(t,e,n){},cNQO:function(t,e,n){},edrR:function(t,e,n){"use strict";var a=n("mKVh");n.n(a).a},mKVh:function(t,e,n){}},[["4Ozd","runtime","chunk-libs"]]]);